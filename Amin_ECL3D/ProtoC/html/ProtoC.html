
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ProtoC</title><meta name="generator" content="MATLAB 8.1"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2014-08-03"><meta name="DC.source" content="ProtoC.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> varargout = ProtoC(varargin)
gui_Singleton = 1;
gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
                   <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
                   <span class="string">'gui_OpeningFcn'</span>, @ProtoC_OpeningFcn, <span class="keyword">...</span>
                   <span class="string">'gui_OutputFcn'</span>,  @ProtoC_OutputFcn, <span class="keyword">...</span>
                   <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
                   <span class="string">'gui_Callback'</span>,   []);
<span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
    gui_State.gui_Callback = str2func(varargin{1});
<span class="keyword">end</span>

<span class="keyword">if</span> nargout
    [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
<span class="keyword">else</span>
    gui_mainfcn(gui_State, varargin{:});
<span class="keyword">end</span>
<span class="keyword">function</span> ProtoC_OpeningFcn(hObject, eventdata, handles, varargin)

handles.output = hObject;
guidata(hObject, handles);
<span class="keyword">function</span> varargout = ProtoC_OutputFcn(hObject, eventdata, handles)
varargout{1} = handles.output;
<span class="keyword">function</span> InitialPot_Edit_Callback(hObject, eventdata, handles)
<span class="keyword">function</span> InitialPot_Edit_CreateFcn(hObject, eventdata, handles)
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>
<span class="keyword">function</span> FinalPot_Edit_Callback(hObject, eventdata, handles)
<span class="keyword">function</span> FinalPot_Edit_CreateFcn(hObject, eventdata, handles)
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>
<span class="keyword">function</span> ScanRate_Edit_Callback(hObject, eventdata, handles)
<span class="keyword">function</span> ScanRate_Edit_CreateFcn(hObject, eventdata, handles)
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>
<span class="keyword">function</span> Segments_Edit_Callback(hObject, eventdata, handles)
<span class="keyword">function</span> Segments_Edit_CreateFcn(hObject, eventdata, handles)
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>
<span class="keyword">function</span> Cycles_Edit_Callback(hObject, eventdata, handles)
<span class="keyword">function</span> Cycles_Edit_CreateFcn(hObject, eventdata, handles)
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>
<span class="keyword">function</span> IntegTime_Edit_Callback(hObject, eventdata, handles)
<span class="keyword">function</span> IntegTime_Edit_CreateFcn(hObject, eventdata, handles)
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>
<span class="keyword">function</span> DelaySpectras_Edit_Callback(hObject, eventdata, handles)
<span class="keyword">function</span> DelaySpectras_Edit_CreateFcn(hObject, eventdata, handles)
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>
<span class="keyword">function</span> DelayTrig_Edit_Callback(hObject, eventdata, handles)
<span class="keyword">function</span> DelayTrig_Edit_CreateFcn(hObject, eventdata, handles)
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>
<span class="keyword">function</span> MeshSize_Edit_Callback(hObject, eventdata, handles)
<span class="keyword">function</span> MeshSize_Edit_CreateFcn(hObject, eventdata, handles)
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>
<span class="keyword">function</span> TimeTick_Callback(hObject, eventdata, handles)
<span class="keyword">function</span> SurfTick_Callback(hObject, eventdata, handles)
<span class="keyword">function</span> SurfCtopTick_Callback(hObject, eventdata, handles)
<span class="keyword">function</span> MeshTick_Callback(hObject, eventdata, handles)
<span class="keyword">function</span> Plot_Callback(hObject, eventdata, handles)

<span class="comment">%</span>
<span class="comment">% Variables</span>
<span class="comment">%</span>

handles=guidata(hObject);
Matrix=handles.Matrix;
Low_Pot=str2double(get(handles.InitialPot_Edit,<span class="string">'string'</span>));
High_Pot=str2double(get(handles.FinalPot_Edit,<span class="string">'string'</span>));
ScanRate=str2double(get(handles.ScanRate_Edit,<span class="string">'string'</span>));
Segments=str2double(get(handles.Segments_Edit,<span class="string">'string'</span>));
Cycles=str2double(get(handles.Cycles_Edit,<span class="string">'string'</span>));
MeshSize=str2double(get(handles.MeshSize_Edit,<span class="string">'string'</span>));
integ_Time=str2double(get(handles.IntegTime_Edit,<span class="string">'string'</span>));
Delay_2=str2double(get(handles.DelaySpectras_Edit,<span class="string">'string'</span>));
Ins_Delay=str2double(get(handles.DelayTrig_Edit,<span class="string">'string'</span>));
Spectra_Time=integ_Time+Delay_2;
S=handles.S;
Counter=0;

<span class="comment">%</span>
<span class="comment">% Core algorithm</span>
<span class="comment">%</span>

colordef(<span class="string">'black'</span>);
Wavelength=(Matrix(1:end,1));
Accumulations=(2:1:length(Matrix(1,1:end)));
Time_Axis=((Accumulations.*(Spectra_Time))-<span class="keyword">...</span>
    (Ins_Delay+Spectra_Time));
Time_Axis(Time_Axis&lt;0)=nan;
[~,col]=find(isnan(Time_Axis));
Matrix(:,(col:max(col)+1))=nan;
Potential=(Time_Axis.*ScanRate);
Initial_point=max(col)+1;
<span class="comment">%</span>
[X,Y]=meshgrid(Time_Axis(1,Initial_point:MeshSize:end),Wavelength(1:MeshSize:end));
[V,W]=meshgrid(Potential(1,Initial_point:MeshSize:end),Wavelength(1:MeshSize:end));
Z=Matrix(1:MeshSize:end,Initial_point+1:MeshSize:end);
handles.W=W;handles.V=V;handles.Z=Z;

<span class="comment">%</span>
<span class="comment">% Time graph</span>
<span class="comment">%</span>

TimeTick=get(handles.TimeTick,<span class="string">'Value'</span>);
<span class="keyword">if</span> TimeTick == 1
    Counter=Counter+1;
figure(<span class="string">'name'</span>,<span class="string">'Amin''s 3D-ECL Plotter - Time Graph'</span>,<span class="string">'numbertitle'</span>,<span class="string">'off'</span>);
surf(Y,X,Z);
movegui(<span class="string">'northeast'</span>);
colormap(<span class="string">'hsv'</span>);
xlabel(<span class="string">'Wavelength (nm)'</span>);
ylabel(<span class="string">'Time (s)'</span>);
zlabel(<span class="string">'Intensity (Counts)'</span>);
title(<span class="string">'Time Graph'</span>);
set(gca,<span class="string">'ytick'</span>,0:5:((length(Potential)*Spectra_Time)));
shading(S)
<span class="keyword">end</span>

<span class="comment">%</span>
<span class="comment">% Potential Conversion</span>
<span class="comment">%</span>

P=Potential;
[~,top]=min(abs(Potential-High_Pot));
top_Pot=P(top);
Step_Pot=ScanRate*Spectra_Time;
P(top+1)=top_Pot-(Step_Pot-(2*(High_Pot-top_Pot))); <span class="comment">% This line is a</span>
<span class="comment">% correction for the High_Potential and the Highest Potential after the</span>
<span class="comment">% first segment's switch back -- Hint: 1.498 - 0.1 -(0.002 + 0.002')=1.492</span>
<span class="keyword">for</span> i=(top+2):1:length(P)
P(i)=P(i-1)-(Step_Pot);
<span class="keyword">end</span>

<span class="comment">%</span>
<span class="comment">% yAxis Alignment</span>
<span class="comment">%</span>

ymin=find(isnan(P), 1, <span class="string">'last'</span> );
P(isnan(P))=0;
ystep=0.25;
y=P(ymin:(ystep/Step_Pot):end);
<span class="comment">% y=round((P(ymin:(ystep/Step_Pot):end))*100)/100;</span>

<span class="comment">%</span>
<span class="comment">% Potential Graph - SurfPlot</span>
<span class="comment">%</span>

SurfTick=get(handles.SurfTick,<span class="string">'Value'</span>);
<span class="keyword">if</span> SurfTick == 1
    Counter=Counter+1;
figure(<span class="string">'name'</span>,<span class="string">'Amin''s 3D-ECL Plotter - Potential Graph'</span>,<span class="string">'numbertitle'</span>,<span class="string">'off'</span>);
surf(W,V,Z);
<span class="comment">% movegui('southeast');</span>
colormap(<span class="string">'hsv'</span>);
xlabel(<span class="string">'Wavelength (nm)'</span>);
ylabel(<span class="string">'Potential (E vs. V)'</span>);
zlabel(<span class="string">'Intensity (Counts)'</span>);
title(<span class="string">'Potential Graph'</span>);
set(gca,<span class="string">'yTick'</span>,0:ystep:length(P));
set(gca,<span class="string">'yticklabel'</span>,y');
shading(S)
<span class="keyword">end</span>

<span class="comment">%</span>
<span class="comment">% Potential Graph - SurfCtopPlot</span>
<span class="comment">%</span>

SurfCtopTick=get(handles.SurfCtopTick,<span class="string">'Value'</span>);
<span class="keyword">if</span> SurfCtopTick == 1
    Counter=Counter+1;
figure(<span class="string">'name'</span>,<span class="string">'Amin''s 3D-ECL Plotter - Potential Graph'</span>,<span class="string">'numbertitle'</span>,<span class="string">'off'</span>);
surfctop(W,V,Z);
<span class="comment">% movegui('southeast');</span>
colormap(<span class="string">'hsv'</span>);
xlabel(<span class="string">'Wavelength (nm)'</span>);
ylabel(<span class="string">'Potential (E vs. V)'</span>);
zlabel(<span class="string">'Intensity (Counts)'</span>);
title(<span class="string">'Potential Graph'</span>);
set(gca,<span class="string">'yTick'</span>,0:ystep:length(P));
set(gca,<span class="string">'yticklabel'</span>,y');
shading(S)
<span class="keyword">end</span>

<span class="comment">%</span>
<span class="comment">% Potential Graph - MeshPlot</span>
<span class="comment">%</span>

MeshTick=get(handles.MeshTick,<span class="string">'Value'</span>);
<span class="keyword">if</span> MeshTick == 1
    Counter=Counter+1;
figure(<span class="string">'name'</span>,<span class="string">'Amin''s 3D-ECL Plotter - Potential Graph'</span>,<span class="string">'numbertitle'</span>,<span class="string">'off'</span>);
mesh(W,V,Z);
<span class="comment">% movegui('northwest');</span>
colormap(<span class="string">'hsv'</span>);
xlabel(<span class="string">'Wavelength (nm)'</span>);
ylabel(<span class="string">'Potential (E vs. V)'</span>);
zlabel(<span class="string">'Intensity (Counts)'</span>);
title(<span class="string">'Potential Graph'</span>);
set(gca,<span class="string">'yTick'</span>,0:ystep:length(P));
set(gca,<span class="string">'yticklabel'</span>,y');
shading(S)
<span class="keyword">end</span>

<span class="comment">%</span>
<span class="comment">% Potential Graph - MeshCtopPlot</span>
<span class="comment">%</span>

MeshCtopTick=get(handles.MeshCtopTick,<span class="string">'Value'</span>);
<span class="keyword">if</span> MeshCtopTick == 1
    Counter=Counter+1;
figure(<span class="string">'name'</span>,<span class="string">'Amin''s 3D-ECL Plotter - Potential Graph'</span>,<span class="string">'numbertitle'</span>,<span class="string">'off'</span>);
meshctop(W,V,Z);
<span class="comment">% movegui('northwest');</span>
colormap(<span class="string">'hsv'</span>);
xlabel(<span class="string">'Wavelength (nm)'</span>);
ylabel(<span class="string">'Potential (E vs. V)'</span>);
zlabel(<span class="string">'Intensity (Counts)'</span>);
title(<span class="string">'Potential Graph'</span>);
set(gca,<span class="string">'yTick'</span>,0:ystep:length(P));
set(gca,<span class="string">'yticklabel'</span>,y');
shading(S)
<span class="keyword">end</span>

<span class="comment">%</span>
<span class="comment">% Potential Graph - ContourPlot</span>
<span class="comment">%</span>

ContourTick=get(handles.ContourTick,<span class="string">'Value'</span>);
<span class="keyword">if</span> ContourTick == 1
    Counter=Counter+1;
figure(<span class="string">'name'</span>,<span class="string">'Amin''s 3D-ECL Plotter - Potential Graph'</span>,<span class="string">'numbertitle'</span>,<span class="string">'off'</span>);
<span class="comment">% movegui('southwest');</span>
contourf(W,V,Z,12,<span class="string">'showtext'</span>,<span class="string">'on'</span>)
grid(<span class="string">'on'</span>);
ylabel(<span class="string">'Potential (E vs. V)'</span>);
xlabel(<span class="string">'Wavelength (nm)'</span>);
title (<span class="string">'Contour Graph'</span>);
colorbar;
set(gca,<span class="string">'yTick'</span>,0:ystep:length(P));
set(gca,<span class="string">'yticklabel'</span>,y');
hold <span class="string">off</span>
<span class="keyword">end</span>
handles.Counter=Counter;
guidata(hObject,handles);

<span class="keyword">function</span> uipushtool1_ClickedCallback(hObject, eventdata, handles)
handles=guidata(hObject);
[FileName, PathName] = uigetfile(<span class="string">'*.csv'</span>);
FileName_A=strcat(PathName,FileName);
Matrix=dlmread(FileName_A,<span class="string">','</span>,2,0);
set(handles.edit10,<span class="string">'string'</span>,<span class="string">'Data-File has been successfully selected!'</span>);
handles.Matrix=Matrix;
guidata(hObject,handles);

<span class="keyword">function</span> Untitled_1_Callback(hObject, eventdata, handles)

<span class="keyword">function</span> Open_File_Menu_Callback(hObject, eventdata, handles)
handles=guidata(hObject);
[FileName, PathName] = uigetfile(<span class="string">'*.csv'</span>);
FileName_A=strcat(PathName,FileName);
Matrix=dlmread(FileName_A,<span class="string">','</span>,2,0);
handles.Matrix=Matrix;
set(handles.edit10,<span class="string">'string'</span>,<span class="string">'Data-File has been successfully selected!'</span>);
guidata(hObject,handles);

<span class="keyword">function</span> Close_Menu_Callback(hObject, eventdata, handles)
closereq;
<span class="keyword">function</span> MeshCtopTick_Callback(hObject, eventdata, handles)

<span class="keyword">function</span> ContourTick_Callback(hObject, eventdata, handles)

<span class="keyword">function</span> Axes1_Logo_CreateFcn(hObject, eventdata, handles)
axes(hObject);
imshow(<span class="string">'logo5.jpg'</span>);

<span class="keyword">function</span> uipanel5_SelectionChangeFcn(hObject, eventdata, handles)
handles=guidata(hObject);
    h=get(handles.uipanel5,<span class="string">'SelectedObject'</span>);
    S=get(h,<span class="string">'Tag'</span>);
    handles.S=S;
guidata(hObject,handles);

<span class="keyword">function</span> edit10_Callback(hObject, eventdata, handles)

<span class="keyword">function</span> edit10_CreateFcn(hObject, eventdata, handles)

<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>

<span class="keyword">function</span> Cleaner_ClickedCallback(hObject, eventdata, handles)
set(handles.axes1,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>);
close <span class="string">all</span>;
set(handles.axes1,<span class="string">'HandleVisibility'</span>,<span class="string">'on'</span>);

<span class="keyword">function</span> Animation_ClickedCallback(hObject, eventdata, handles)
handles=guidata(hObject);

Matrix=handles.Matrix;
Low_Pot=str2double(get(handles.InitialPot_Edit,<span class="string">'string'</span>));
High_Pot=str2double(get(handles.FinalPot_Edit,<span class="string">'string'</span>));
ScanRate=str2double(get(handles.ScanRate_Edit,<span class="string">'string'</span>));
Segments=str2double(get(handles.Segments_Edit,<span class="string">'string'</span>));
Cycles=str2double(get(handles.Cycles_Edit,<span class="string">'string'</span>));
MeshSize=str2double(get(handles.MeshSize_Edit,<span class="string">'string'</span>));
integ_Time=str2double(get(handles.IntegTime_Edit,<span class="string">'string'</span>));
Delay_2=str2double(get(handles.DelaySpectras_Edit,<span class="string">'string'</span>));
Ins_Delay=str2double(get(handles.DelayTrig_Edit,<span class="string">'string'</span>));
Spectra_Time=integ_Time+Delay_2;

colordef(<span class="string">'black'</span>);
Wavelength=(Matrix(1:end,1));
Accumulations=(2:1:length(Matrix(1,1:end)));
Time_Axis=((Accumulations.*(Spectra_Time))-<span class="keyword">...</span>
    (Ins_Delay+Spectra_Time));
Time_Axis(Time_Axis&lt;0)=nan;
[~,col]=find(isnan(Time_Axis));
Matrix(:,(col:max(col)+1))=nan;
Potential=(Time_Axis.*ScanRate);
Initial_point=max(col)+1;

[V,W]=meshgrid(Potential(1,Initial_point:MeshSize:end),Wavelength(1:MeshSize:end));
Z=Matrix(1:MeshSize:end,Initial_point+1:MeshSize:end);

<span class="comment">%-----------------</span>
<span class="comment">%</span>
<span class="comment">% Potential Conversion</span>
<span class="comment">%</span>

P=Potential;
[~,top]=min(abs(Potential-High_Pot));
top_Pot=P(top);
Step_Pot=ScanRate*Spectra_Time;
P(top+1)=top_Pot-(Step_Pot-(2*(High_Pot-top_Pot))); <span class="comment">% This line is a</span>
<span class="comment">% correction for the High_Potential and the Highest Potential after the</span>
<span class="comment">% first segment's switch back -- Hint: 1.498 - 0.1 -(0.002 + 0.002')=1.492</span>
<span class="keyword">for</span> i=(top+2):1:length(P)
P(i)=P(i-1)-(Step_Pot);
<span class="keyword">end</span>

<span class="comment">%</span>
<span class="comment">% yAxis Alignment</span>
<span class="comment">%</span>

ymin=find(isnan(P), 1, <span class="string">'last'</span> );
P(isnan(P))=0;
ystep=0.25;
y=P(ymin:(ystep/Step_Pot):end);
<span class="comment">% y=round((P(ymin:(ystep/Step_Pot):end))*100)/100;</span>
<span class="comment">%-----------------</span>


set(handles.axes1,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>);
close <span class="string">all</span>;
set(handles.axes1,<span class="string">'HandleVisibility'</span>,<span class="string">'on'</span>);


writerObj=VideoWriter(<span class="string">'3DVideo.avi'</span>);
open(writerObj);

figure(<span class="string">'name'</span>,<span class="string">'Amin''s 3D-ECL Plotter - Potential Graph'</span>,<span class="string">'numbertitle'</span>,<span class="string">'off'</span>);
surf(W,V,Z);
axis <span class="string">tight</span>
set(gca,<span class="string">'nextplot'</span>,<span class="string">'replacechildren'</span>);
set(gcf,<span class="string">'Render'</span>,<span class="string">'zbuffer'</span>);
colormap(<span class="string">'hsv'</span>);
xlabel(<span class="string">'Wavelength (nm)'</span>);
ylabel(<span class="string">'Potential (E vs. V)'</span>);
zlabel(<span class="string">'Intensity (Counts)'</span>);
title(<span class="string">'Potential Graph'</span>);
set(gca,<span class="string">'yTick'</span>,0:ystep:length(P))
set(gca,<span class="string">'yticklabel'</span>,y');
shading <span class="string">interp</span>;

view(-25,30);
<span class="keyword">for</span> i=1:360
   view(-25+i,30);
   frame = getframe(gcf);
   writeVideo(writerObj,frame);
   pause(0.06);
<span class="keyword">end</span>
 close(writerObj);
guidata(hObject,handles);


<span class="comment">% --------------------------------------------------------------------</span>
<span class="keyword">function</span> uipushtool6_ClickedCallback(hObject, eventdata, handles)
handles=guidata(hObject);

Matrix=handles.Matrix;
Low_Pot=str2double(get(handles.InitialPot_Edit,<span class="string">'string'</span>));
High_Pot=str2double(get(handles.FinalPot_Edit,<span class="string">'string'</span>));
ScanRate=str2double(get(handles.ScanRate_Edit,<span class="string">'string'</span>));
Segments=str2double(get(handles.Segments_Edit,<span class="string">'string'</span>));
Cycles=str2double(get(handles.Cycles_Edit,<span class="string">'string'</span>));
MeshSize=str2double(get(handles.MeshSize_Edit,<span class="string">'string'</span>));
integ_Time=str2double(get(handles.IntegTime_Edit,<span class="string">'string'</span>));
Delay_2=str2double(get(handles.DelaySpectras_Edit,<span class="string">'string'</span>));
Ins_Delay=str2double(get(handles.DelayTrig_Edit,<span class="string">'string'</span>));
Spectra_Time=integ_Time+Delay_2;

colordef(<span class="string">'black'</span>);
Wavelength=(Matrix(1:end,1));
Accumulations=(2:1:length(Matrix(1,1:end)));
Time_Axis=((Accumulations.*(Spectra_Time))-<span class="keyword">...</span>
    (Ins_Delay+Spectra_Time));
Time_Axis(Time_Axis&lt;0)=nan;
[~,col]=find(isnan(Time_Axis));
Matrix(:,(col:max(col)+1))=nan;
Potential=(Time_Axis.*ScanRate);
Initial_point=max(col)+1;

[V,W]=meshgrid(Potential(1,Initial_point:MeshSize:end),Wavelength(1:MeshSize:end));
Z=Matrix(1:MeshSize:end,Initial_point+1:MeshSize:end);

<span class="comment">%-----------------</span>
<span class="comment">%</span>
<span class="comment">% Potential Conversion</span>
<span class="comment">%</span>

P=Potential;
[~,top]=min(abs(Potential-High_Pot));
top_Pot=P(top);
Step_Pot=ScanRate*Spectra_Time;
P(top+1)=top_Pot-(Step_Pot-(2*(High_Pot-top_Pot))); <span class="comment">% This line is a</span>
<span class="comment">% correction for the High_Potential and the Highest Potential after the</span>
<span class="comment">% first segment's switch back -- Hint: 1.498 - 0.1 -(0.002 + 0.002')=1.492</span>
<span class="keyword">for</span> i=(top+2):1:length(P)
P(i)=P(i-1)-(Step_Pot);
<span class="keyword">end</span>

<span class="comment">%</span>
<span class="comment">% yAxis Alignment</span>
<span class="comment">%</span>

ymin=find(isnan(P), 1, <span class="string">'last'</span> );
P(isnan(P))=0;
ystep=0.25;
y=P(ymin:(ystep/Step_Pot):end);
<span class="comment">% y=round((P(ymin:(ystep/Step_Pot):end))*100)/100;</span>
<span class="comment">%-----------------</span>

set(handles.axes1,<span class="string">'HandleVisibility'</span>,<span class="string">'off'</span>);
close <span class="string">all</span>;
set(handles.axes1,<span class="string">'HandleVisibility'</span>,<span class="string">'on'</span>);


figure(<span class="string">'name'</span>,<span class="string">'Amin''s 3D-ECL Plotter - Potential Graph'</span>,<span class="string">'numbertitle'</span>,<span class="string">'off'</span>);
surf(W,V,Z);
colormap(<span class="string">'hsv'</span>);
xlabel(<span class="string">'Wavelength (nm)'</span>);
ylabel(<span class="string">'Potential (E vs. V)'</span>);
zlabel(<span class="string">'Intensity (Counts)'</span>);
title(<span class="string">'Potential Graph'</span>);
set(gca,<span class="string">'yTick'</span>,0:ystep:length(P))
set(gca,<span class="string">'yticklabel'</span>,y');
shading <span class="string">interp</span>;

view(-25,30);
<span class="keyword">for</span> i=1:360
   view(-25+i,30);
   pause(0.06);
<span class="keyword">end</span>

guidata(hObject,handles);


<span class="comment">% --------------------------------------------------------------------</span>
<span class="keyword">function</span> Help_Menu_Callback(hObject, eventdata, handles)
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2013a</a><br></p></div><!--
##### SOURCE BEGIN #####
function varargout = ProtoC(varargin)
gui_Singleton = 1;
gui_State = struct('gui_Name',       mfilename, ...
                   'gui_Singleton',  gui_Singleton, ...
                   'gui_OpeningFcn', @ProtoC_OpeningFcn, ...
                   'gui_OutputFcn',  @ProtoC_OutputFcn, ...
                   'gui_LayoutFcn',  [] , ...
                   'gui_Callback',   []);
if nargin && ischar(varargin{1})
    gui_State.gui_Callback = str2func(varargin{1});
end

if nargout
    [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
else
    gui_mainfcn(gui_State, varargin{:});
end
function ProtoC_OpeningFcn(hObject, eventdata, handles, varargin)

handles.output = hObject;
guidata(hObject, handles);
function varargout = ProtoC_OutputFcn(hObject, eventdata, handles) 
varargout{1} = handles.output;
function InitialPot_Edit_Callback(hObject, eventdata, handles)
function InitialPot_Edit_CreateFcn(hObject, eventdata, handles)
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end
function FinalPot_Edit_Callback(hObject, eventdata, handles)
function FinalPot_Edit_CreateFcn(hObject, eventdata, handles)
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end
function ScanRate_Edit_Callback(hObject, eventdata, handles)
function ScanRate_Edit_CreateFcn(hObject, eventdata, handles)
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end
function Segments_Edit_Callback(hObject, eventdata, handles)
function Segments_Edit_CreateFcn(hObject, eventdata, handles)
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end
function Cycles_Edit_Callback(hObject, eventdata, handles)
function Cycles_Edit_CreateFcn(hObject, eventdata, handles)
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end
function IntegTime_Edit_Callback(hObject, eventdata, handles)
function IntegTime_Edit_CreateFcn(hObject, eventdata, handles)
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end
function DelaySpectras_Edit_Callback(hObject, eventdata, handles)
function DelaySpectras_Edit_CreateFcn(hObject, eventdata, handles)
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end
function DelayTrig_Edit_Callback(hObject, eventdata, handles)
function DelayTrig_Edit_CreateFcn(hObject, eventdata, handles)
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end
function MeshSize_Edit_Callback(hObject, eventdata, handles)
function MeshSize_Edit_CreateFcn(hObject, eventdata, handles)
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end
function TimeTick_Callback(hObject, eventdata, handles)
function SurfTick_Callback(hObject, eventdata, handles)
function SurfCtopTick_Callback(hObject, eventdata, handles)
function MeshTick_Callback(hObject, eventdata, handles)
function Plot_Callback(hObject, eventdata, handles)

%
% Variables
%

handles=guidata(hObject);
Matrix=handles.Matrix;
Low_Pot=str2double(get(handles.InitialPot_Edit,'string'));
High_Pot=str2double(get(handles.FinalPot_Edit,'string'));
ScanRate=str2double(get(handles.ScanRate_Edit,'string'));
Segments=str2double(get(handles.Segments_Edit,'string'));
Cycles=str2double(get(handles.Cycles_Edit,'string'));
MeshSize=str2double(get(handles.MeshSize_Edit,'string'));
integ_Time=str2double(get(handles.IntegTime_Edit,'string'));
Delay_2=str2double(get(handles.DelaySpectras_Edit,'string'));
Ins_Delay=str2double(get(handles.DelayTrig_Edit,'string'));
Spectra_Time=integ_Time+Delay_2;
S=handles.S;
Counter=0;

%
% Core algorithm
%

colordef('black');
Wavelength=(Matrix(1:end,1));
Accumulations=(2:1:length(Matrix(1,1:end)));
Time_Axis=((Accumulations.*(Spectra_Time))-...
    (Ins_Delay+Spectra_Time));
Time_Axis(Time_Axis<0)=nan;
[~,col]=find(isnan(Time_Axis));
Matrix(:,(col:max(col)+1))=nan;
Potential=(Time_Axis.*ScanRate);
Initial_point=max(col)+1;
%
[X,Y]=meshgrid(Time_Axis(1,Initial_point:MeshSize:end),Wavelength(1:MeshSize:end));
[V,W]=meshgrid(Potential(1,Initial_point:MeshSize:end),Wavelength(1:MeshSize:end));
Z=Matrix(1:MeshSize:end,Initial_point+1:MeshSize:end);
handles.W=W;handles.V=V;handles.Z=Z;

%
% Time graph
%

TimeTick=get(handles.TimeTick,'Value');
if TimeTick == 1
    Counter=Counter+1;
figure('name','Amin''s 3D-ECL Plotter - Time Graph','numbertitle','off');
surf(Y,X,Z);
movegui('northeast');
colormap('hsv');
xlabel('Wavelength (nm)');
ylabel('Time (s)');
zlabel('Intensity (Counts)');
title('Time Graph');
set(gca,'ytick',0:5:((length(Potential)*Spectra_Time)));
shading(S)
end

%
% Potential Conversion
%

P=Potential;
[~,top]=min(abs(Potential-High_Pot));
top_Pot=P(top);
Step_Pot=ScanRate*Spectra_Time;
P(top+1)=top_Pot-(Step_Pot-(2*(High_Pot-top_Pot))); % This line is a
% correction for the High_Potential and the Highest Potential after the
% first segment's switch back REPLACE_WITH_DASH_DASH Hint: 1.498 - 0.1 -(0.002 + 0.002')=1.492
for i=(top+2):1:length(P)
P(i)=P(i-1)-(Step_Pot);
end

%
% yAxis Alignment
%

ymin=find(isnan(P), 1, 'last' );
P(isnan(P))=0;
ystep=0.25;
y=P(ymin:(ystep/Step_Pot):end);
% y=round((P(ymin:(ystep/Step_Pot):end))*100)/100;

%
% Potential Graph - SurfPlot
%

SurfTick=get(handles.SurfTick,'Value');
if SurfTick == 1
    Counter=Counter+1;
figure('name','Amin''s 3D-ECL Plotter - Potential Graph','numbertitle','off');
surf(W,V,Z);
% movegui('southeast');
colormap('hsv');
xlabel('Wavelength (nm)');
ylabel('Potential (E vs. V)');
zlabel('Intensity (Counts)');
title('Potential Graph');
set(gca,'yTick',0:ystep:length(P));
set(gca,'yticklabel',y');
shading(S)
end

%
% Potential Graph - SurfCtopPlot
%

SurfCtopTick=get(handles.SurfCtopTick,'Value');
if SurfCtopTick == 1
    Counter=Counter+1;
figure('name','Amin''s 3D-ECL Plotter - Potential Graph','numbertitle','off');
surfctop(W,V,Z);
% movegui('southeast');
colormap('hsv');
xlabel('Wavelength (nm)');
ylabel('Potential (E vs. V)');
zlabel('Intensity (Counts)');
title('Potential Graph');
set(gca,'yTick',0:ystep:length(P));
set(gca,'yticklabel',y');
shading(S)
end

%
% Potential Graph - MeshPlot
%

MeshTick=get(handles.MeshTick,'Value');
if MeshTick == 1
    Counter=Counter+1;
figure('name','Amin''s 3D-ECL Plotter - Potential Graph','numbertitle','off');
mesh(W,V,Z);
% movegui('northwest');
colormap('hsv');
xlabel('Wavelength (nm)');
ylabel('Potential (E vs. V)');
zlabel('Intensity (Counts)');
title('Potential Graph');
set(gca,'yTick',0:ystep:length(P));
set(gca,'yticklabel',y');
shading(S)
end

%
% Potential Graph - MeshCtopPlot
%

MeshCtopTick=get(handles.MeshCtopTick,'Value');
if MeshCtopTick == 1
    Counter=Counter+1;
figure('name','Amin''s 3D-ECL Plotter - Potential Graph','numbertitle','off');
meshctop(W,V,Z);
% movegui('northwest');
colormap('hsv');
xlabel('Wavelength (nm)');
ylabel('Potential (E vs. V)');
zlabel('Intensity (Counts)');
title('Potential Graph');
set(gca,'yTick',0:ystep:length(P));
set(gca,'yticklabel',y');
shading(S)
end

%
% Potential Graph - ContourPlot
%

ContourTick=get(handles.ContourTick,'Value');
if ContourTick == 1
    Counter=Counter+1;
figure('name','Amin''s 3D-ECL Plotter - Potential Graph','numbertitle','off');
% movegui('southwest');
contourf(W,V,Z,12,'showtext','on')
grid('on');
ylabel('Potential (E vs. V)');
xlabel('Wavelength (nm)');
title ('Contour Graph');
colorbar;
set(gca,'yTick',0:ystep:length(P));
set(gca,'yticklabel',y');
hold off
end
handles.Counter=Counter;
guidata(hObject,handles);

function uipushtool1_ClickedCallback(hObject, eventdata, handles)
handles=guidata(hObject);
[FileName, PathName] = uigetfile('*.csv');
FileName_A=strcat(PathName,FileName);
Matrix=dlmread(FileName_A,',',2,0);
set(handles.edit10,'string','Data-File has been successfully selected!');
handles.Matrix=Matrix;
guidata(hObject,handles);

function Untitled_1_Callback(hObject, eventdata, handles)

function Open_File_Menu_Callback(hObject, eventdata, handles)
handles=guidata(hObject);
[FileName, PathName] = uigetfile('*.csv');
FileName_A=strcat(PathName,FileName);
Matrix=dlmread(FileName_A,',',2,0);
handles.Matrix=Matrix;
set(handles.edit10,'string','Data-File has been successfully selected!');
guidata(hObject,handles);

function Close_Menu_Callback(hObject, eventdata, handles)
closereq;
function MeshCtopTick_Callback(hObject, eventdata, handles)

function ContourTick_Callback(hObject, eventdata, handles)

function Axes1_Logo_CreateFcn(hObject, eventdata, handles)
axes(hObject);
imshow('logo5.jpg');

function uipanel5_SelectionChangeFcn(hObject, eventdata, handles)
handles=guidata(hObject);    
    h=get(handles.uipanel5,'SelectedObject');    
    S=get(h,'Tag');
    handles.S=S;
guidata(hObject,handles);

function edit10_Callback(hObject, eventdata, handles)

function edit10_CreateFcn(hObject, eventdata, handles)

if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end

function Cleaner_ClickedCallback(hObject, eventdata, handles)
set(handles.axes1,'HandleVisibility','off');
close all;
set(handles.axes1,'HandleVisibility','on');

function Animation_ClickedCallback(hObject, eventdata, handles)
handles=guidata(hObject);

Matrix=handles.Matrix;
Low_Pot=str2double(get(handles.InitialPot_Edit,'string'));
High_Pot=str2double(get(handles.FinalPot_Edit,'string'));
ScanRate=str2double(get(handles.ScanRate_Edit,'string'));
Segments=str2double(get(handles.Segments_Edit,'string'));
Cycles=str2double(get(handles.Cycles_Edit,'string'));
MeshSize=str2double(get(handles.MeshSize_Edit,'string'));
integ_Time=str2double(get(handles.IntegTime_Edit,'string'));
Delay_2=str2double(get(handles.DelaySpectras_Edit,'string'));
Ins_Delay=str2double(get(handles.DelayTrig_Edit,'string'));
Spectra_Time=integ_Time+Delay_2;

colordef('black');
Wavelength=(Matrix(1:end,1));
Accumulations=(2:1:length(Matrix(1,1:end)));
Time_Axis=((Accumulations.*(Spectra_Time))-...
    (Ins_Delay+Spectra_Time));
Time_Axis(Time_Axis<0)=nan;
[~,col]=find(isnan(Time_Axis));
Matrix(:,(col:max(col)+1))=nan;
Potential=(Time_Axis.*ScanRate);
Initial_point=max(col)+1;

[V,W]=meshgrid(Potential(1,Initial_point:MeshSize:end),Wavelength(1:MeshSize:end));
Z=Matrix(1:MeshSize:end,Initial_point+1:MeshSize:end);

%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%
% Potential Conversion
%

P=Potential;
[~,top]=min(abs(Potential-High_Pot));
top_Pot=P(top);
Step_Pot=ScanRate*Spectra_Time;
P(top+1)=top_Pot-(Step_Pot-(2*(High_Pot-top_Pot))); % This line is a
% correction for the High_Potential and the Highest Potential after the
% first segment's switch back REPLACE_WITH_DASH_DASH Hint: 1.498 - 0.1 -(0.002 + 0.002')=1.492
for i=(top+2):1:length(P)
P(i)=P(i-1)-(Step_Pot);
end

%
% yAxis Alignment
%

ymin=find(isnan(P), 1, 'last' );
P(isnan(P))=0;
ystep=0.25;
y=P(ymin:(ystep/Step_Pot):end);
% y=round((P(ymin:(ystep/Step_Pot):end))*100)/100;
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-


set(handles.axes1,'HandleVisibility','off');
close all;
set(handles.axes1,'HandleVisibility','on');


writerObj=VideoWriter('3DVideo.avi');
open(writerObj);

figure('name','Amin''s 3D-ECL Plotter - Potential Graph','numbertitle','off');
surf(W,V,Z);
axis tight
set(gca,'nextplot','replacechildren');
set(gcf,'Render','zbuffer');
colormap('hsv');
xlabel('Wavelength (nm)');
ylabel('Potential (E vs. V)');
zlabel('Intensity (Counts)');
title('Potential Graph');
set(gca,'yTick',0:ystep:length(P))
set(gca,'yticklabel',y');
shading interp;

view(-25,30);
for i=1:360
   view(-25+i,30); 
   frame = getframe(gcf);
   writeVideo(writerObj,frame);
   pause(0.06);
end
 close(writerObj);
guidata(hObject,handles);


% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
function uipushtool6_ClickedCallback(hObject, eventdata, handles)
handles=guidata(hObject);

Matrix=handles.Matrix;
Low_Pot=str2double(get(handles.InitialPot_Edit,'string'));
High_Pot=str2double(get(handles.FinalPot_Edit,'string'));
ScanRate=str2double(get(handles.ScanRate_Edit,'string'));
Segments=str2double(get(handles.Segments_Edit,'string'));
Cycles=str2double(get(handles.Cycles_Edit,'string'));
MeshSize=str2double(get(handles.MeshSize_Edit,'string'));
integ_Time=str2double(get(handles.IntegTime_Edit,'string'));
Delay_2=str2double(get(handles.DelaySpectras_Edit,'string'));
Ins_Delay=str2double(get(handles.DelayTrig_Edit,'string'));
Spectra_Time=integ_Time+Delay_2;

colordef('black');
Wavelength=(Matrix(1:end,1));
Accumulations=(2:1:length(Matrix(1,1:end)));
Time_Axis=((Accumulations.*(Spectra_Time))-...
    (Ins_Delay+Spectra_Time));
Time_Axis(Time_Axis<0)=nan;
[~,col]=find(isnan(Time_Axis)); 
Matrix(:,(col:max(col)+1))=nan;
Potential=(Time_Axis.*ScanRate);
Initial_point=max(col)+1;

[V,W]=meshgrid(Potential(1,Initial_point:MeshSize:end),Wavelength(1:MeshSize:end));
Z=Matrix(1:MeshSize:end,Initial_point+1:MeshSize:end);

%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%
% Potential Conversion
%

P=Potential;
[~,top]=min(abs(Potential-High_Pot));
top_Pot=P(top);
Step_Pot=ScanRate*Spectra_Time;
P(top+1)=top_Pot-(Step_Pot-(2*(High_Pot-top_Pot))); % This line is a
% correction for the High_Potential and the Highest Potential after the
% first segment's switch back REPLACE_WITH_DASH_DASH Hint: 1.498 - 0.1 -(0.002 + 0.002')=1.492
for i=(top+2):1:length(P)
P(i)=P(i-1)-(Step_Pot);
end

%
% yAxis Alignment
%

ymin=find(isnan(P), 1, 'last' );
P(isnan(P))=0;
ystep=0.25;
y=P(ymin:(ystep/Step_Pot):end);
% y=round((P(ymin:(ystep/Step_Pot):end))*100)/100;
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-

set(handles.axes1,'HandleVisibility','off');
close all;
set(handles.axes1,'HandleVisibility','on');


figure('name','Amin''s 3D-ECL Plotter - Potential Graph','numbertitle','off');
surf(W,V,Z);
colormap('hsv');
xlabel('Wavelength (nm)');
ylabel('Potential (E vs. V)');
zlabel('Intensity (Counts)');
title('Potential Graph');
set(gca,'yTick',0:ystep:length(P))
set(gca,'yticklabel',y');
shading interp;

view(-25,30);
for i=1:360
   view(-25+i,30); 
   pause(0.06);
end
 
guidata(hObject,handles);


% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
function Help_Menu_Callback(hObject, eventdata, handles)
##### SOURCE END #####
--></body></html>